<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>GEMLIU</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<meta name="description" content="GEMLIU"/>
<meta name="keywords" content="GEMLIU"/>
<link rel="shortcut icon" href="https://gemliu.github.io/favicon.ico">
<link rel="stylesheet" href="https://gemliu.github.io/styles/main.css">


<!-- Comment -->


<link href="https://cdn.bootcss.com/font-awesome/5.11.2/css/all.min.css" rel="stylesheet">



<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@200&display=swap" rel="stylesheet">
</head>
<body class="post-template">
<div id="page" class="site">

    <header class="site-header">
    <h1 class="site-title"><a href="https://gemliu.github.io">GEMLIU</a></h1>
    <a class="sidebar-toggle"><span class="screen-reader-text">Menu</span><span class="icon" aria-hidden="true"></span></a>
</header>

<aside class="sidebar">
    <div class="sidebar-scrollable">
        <div class="inner">
            <div class="widget-area">
                <!-- 菜单 -->
                <nav class="site-navigation">
                    <h2 class="widget-title">MENU</h2>
                    <ul class="menu">
                        
                            <li class="menu-item home current-menu-item">
                                <a href="https://gemliu.github.io"
                                >Home</a>
                            </li>
                        
                            <li class="menu-item home current-menu-item">
                                <a href="https://gemliu.github.io/archives"
                                >Archives</a>
                            </li>
                        
                    </ul>
                </nav>

                <section class="widget widget-tags">
                    <h2 class="widget-title">ABOUT</h2>
                    <div class="CV">
                        <a href="https://gemliu.github.io/about-me-cn">GEMLIU</a><br/>
                    </div>
                </section>

                <section class="widget widget-tags">
                    <h2 class="widget-title">TAGS</h2>
                    <div class="tagcloud">
                        
                            <a href="https://gemliu.github.io/difference-in-difference/" class="button">
                                Difference-in-difference
                                <span aria-hidden="true"><span class="line left"></span><span class="line top"></span><span class="line right"></span><span class="line bottom"></span></span>
                            </a>
                        
                            <a href="https://gemliu.github.io/hong-kong-fiction/" class="button">
                                Hong Kong Fiction
                                <span aria-hidden="true"><span class="line left"></span><span class="line top"></span><span class="line right"></span><span class="line bottom"></span></span>
                            </a>
                        
                            <a href="https://gemliu.github.io/sexual-relations/" class="button">
                                Sexual Relations
                                <span aria-hidden="true"><span class="line left"></span><span class="line top"></span><span class="line right"></span><span class="line bottom"></span></span>
                            </a>
                        
                            <a href="https://gemliu.github.io/love/" class="button">
                                Love
                                <span aria-hidden="true"><span class="line left"></span><span class="line top"></span><span class="line right"></span><span class="line bottom"></span></span>
                            </a>
                        
                            <a href="https://gemliu.github.io/less-is-more/" class="button">
                                Less is More
                                <span aria-hidden="true"><span class="line left"></span><span class="line top"></span><span class="line right"></span><span class="line bottom"></span></span>
                            </a>
                        
                            <a href="https://gemliu.github.io/okr/" class="button">
                                OKR
                                <span aria-hidden="true"><span class="line left"></span><span class="line top"></span><span class="line right"></span><span class="line bottom"></span></span>
                            </a>
                        
                            <a href="https://gemliu.github.io/management/" class="button">
                                Management
                                <span aria-hidden="true"><span class="line left"></span><span class="line top"></span><span class="line right"></span><span class="line bottom"></span></span>
                            </a>
                        
                            <a href="https://gemliu.github.io/career-woman/" class="button">
                                Career Woman
                                <span aria-hidden="true"><span class="line left"></span><span class="line top"></span><span class="line right"></span><span class="line bottom"></span></span>
                            </a>
                        
                            <a href="https://gemliu.github.io/housewife/" class="button">
                                Housewife
                                <span aria-hidden="true"><span class="line left"></span><span class="line top"></span><span class="line right"></span><span class="line bottom"></span></span>
                            </a>
                        
                            <a href="https://gemliu.github.io/innovation/" class="button">
                                Innovation
                                <span aria-hidden="true"><span class="line left"></span><span class="line top"></span><span class="line right"></span><span class="line bottom"></span></span>
                            </a>
                        
                            <a href="https://gemliu.github.io/entrepreneurship/" class="button">
                                Entrepreneurship
                                <span aria-hidden="true"><span class="line left"></span><span class="line top"></span><span class="line right"></span><span class="line bottom"></span></span>
                            </a>
                        
                    </div>
                </section>

            </div>
            <a class="sidebar-toggle"><span class="screen-reader-text">Close</span><span class="icon" aria-hidden="true"></span></a>
        </div>
    </div>
</aside>


    <main class="site-main">
        <div class="site-content">
            <article class="post tag-getting-started">
                <header class="cover post-header">
                    <div class="cover-bg" >

                        
                            <img srcset="https://gemliu.github.io/post-images/difference-in-difference-model.png 300w, https://gemliu.github.io/post-images/difference-in-difference-model.png 600w, https://gemliu.github.io/post-images/difference-in-difference-model.png 800w, https://gemliu.github.io/post-images/difference-in-difference-model.png 1600w, https://gemliu.github.io/post-images/difference-in-difference-model.png 2000w"
                                 sizes="100vw" src="https://gemliu.github.io/post-images/difference-in-difference-model.png" alt="【学习笔记】关于双重差分法（DID）"/>
                        

                    </div>
                    <div class="cover-content">
                        <div class="inner">
                            <div class="post-tags">
                                
                                    
                                        <a href="https://gemliu.github.io/difference-in-difference/">Difference-in-difference&nbsp;&nbsp;</a>
                                    
                                
                            </div>
                            <h1 class="post-title">【学习笔记】关于双重差分法（DID）</h1>
                            <div class="post-meta">
                                <span class="post-meta-wrap">
                                    <img class="author-avatar"
                                         srcset="https://gemliu.github.io/media/images/avatar.png, https://gemliu.github.io/media/images/avatar.png 2x"
                                         src="https://gemliu.github.io/media/images/avatar.png" alt=""/>
                                    <span class="post-author">2518字</span>
                                    <time class="published" datetime="2021-07-22">2021-07-22</time>
                                </span>
                                <div>9 min read</div>
                            </div>
                            <a href="#post-content" class="arrow-down" data-scroll><span class="screen-reader-text">Scroll Down</span></a>
                        </div>
                    </div>
                </header>
                <div class="inner">
                    
                    <br/> 
                    <br/> 
                    <div class="markdown mb-16 note-serif-sc-font" v-pre>
                        <p>估计政策效应常用的方法有：工具变量法、断点回归、倾向得分匹配法、<strong>双重差分法</strong>、合成控制法等</p>
<p><strong>双重差分法 DID（Difference-in-Difference）</strong></p>
<p>估计处理效应中应用最广泛的计量方法，1855年霍乱流行时期由医学家John Snow提出，1915年由Obenauer以及von der Nienburg在研究最小工资法的影响效应时引入经济学的。双重差分适用于估计有多个被处理的对象的处理组的处理效应（treatment effect）。<em>①比较实际观测到的数据（处理组/受处理的数据）&amp;反事实数据（假设未受处理的数据）之间的差异；②比较处理组前后变化与控制组（各方面与处理组相似、但未受处理的控制组）的前后变化之差</em></p>
<ul>
<li>
<p>优势：<br>
（1）可以很大程度上避免内生性问题的困扰：政策相对于微观经济主体而言一般是外生的，因而不存在逆向因果问题。此外，使用固定效应估计一定程度上也缓解了遗漏变量偏误问题。<br>
（2）传统方法下评估政策效应，主要是通过设置一个政策发生与否的虚拟变量然后进行回归，相较而言，双重差分法的模型设置更加科学，能更加准确地估计出政策效应。<br>
（3）双重差分法的原理和模型设置很简单，容易理解和运用</p>
</li>
<li>
<p>关键条件：<br>
（1）必须存在一个具有试点性质的政策冲击，不能是“一刀切”类型，即存在受政策影响的处理组和不受政策影响的控制组，那种一次性全铺开的政策并不适用于DID分析<br>
（2）必须具有一个相应的至少两年（政策实施前后各一年）的面板数据集</p>
</li>
<li>
<p>模型前提：<br>
（1）平行趋势（CT）假设：处理组和对照组有共同趋势，在政策干预之前，处理组和控制组的结果效应的趋势应该是一样的。（检验发现满足共同趋势，则直接采用DID；若不满足，则需要使用基于倾向得分匹配法的双重差分法 (PSM-DID)，在总的控制组中选择与处理组具有相同或相似倾向得分值的样本作为处理组的实际使用的控制组，构造出一个与处理组具有共同趋势的控制组）<br>
（2）SUTVA条件：政策干预只影响处理组，不会对控制组产生交互影响，或者政策干预不会产生外溢效应；<br>
（3）线性形式条件：潜在结果变量同处理变量和时间变量满足线性条件。</p>
</li>
</ul>
<p><strong>一、传统DID模型——具有相同政策时点的标准倍分法 (Standard DID) 模型&amp;与ESA方法结合思路</strong></p>
<p><em>一般针对政策实施时点为同一个时期，且接受干预的状态将一直持续下去，否则交互项设置将会严重违背平行趋势的假设，从而导致交互项的估计系数有偏。</em></p>
<ul>
<li>
<p>传统DID模型=双向固定效应模型+处理组虚拟变量&amp;处理期虚拟变量的交乘项<br>
<img src="https://gemliu.github.io/post-images/1627188379641.png" alt="" loading="lazy"></p>
</li>
<li>
<p>模拟数据的生成<br>
<img src="https://gemliu.github.io/post-images/1627304822978.png" alt="" loading="lazy"></p>
</li>
</ul>
<p><strong>1）政策效果不随时间而变的 Standard DID 的模拟</strong></p>
<p><img src="https://gemliu.github.io/post-images/1627215631435.png" alt="" loading="lazy"><br>
<img src="https://gemliu.github.io/post-images/1627268360181.png" alt="" loading="lazy"></p>
<p><strong>2） 政策效果随时间而变的 Standard DID 的模拟</strong></p>
<p><img src="https://gemliu.github.io/post-images/1627269582024.png" alt="" loading="lazy"><br>
<img src="https://gemliu.github.io/post-images/1627269590587.png" alt="" loading="lazy"></p>
<ul>
<li>Standard DID 和 Event Study Approach 的结合：政策的动态效果(Dynamic Effects) /灵活的 DID （Flexible DID Estimates）</li>
</ul>
<p><em>政策效果随时间变化和不随时间变化两种情况下，如何与时间研究法(Event Study Approach)结合</em></p>
<p>DID 应用 ESA 方法的两个目的：①可利用回归方法对双重差分法中最重要的平行趋势假设进行检验，与图示法相比，好处在于可以控制协变量的影响，方程形式也更加灵活；②可更加清楚地得到政策效果在时间维度上地变化。</p>
<p><strong>1）灵活的 DID ：政策效果不随时间发生变化</strong></p>
<figure data-type="image" tabindex="1"><img src="https://gemliu.github.io/post-images/1627277432349.png" alt="" loading="lazy"></figure>
<p><strong>2）灵活的 DID ：政策效果随时间发生变化</strong></p>
<figure data-type="image" tabindex="2"><img src="https://gemliu.github.io/post-images/1627277672574.png" alt="" loading="lazy"></figure>
<p><strong>稳定性检验：以 Standard DID 为例</strong></p>
<p>① Standard DID 可以认为是一种一直有控制组个体的 DID 模型，从相对时间值这个角度来说，与尽Time-varying DID 模型相通；</p>
<p>② Standard DID 的动态政策效果已经可以通过成熟的办法来得到，有了明确的标准，则可以对处理是否合适进行判断。</p>
<figure data-type="image" tabindex="3"><img src="https://gemliu.github.io/post-images/1627302895045.png" alt="" loading="lazy"></figure>
<ul>
<li>小结<br>
介绍政策效果不随时间而变和政策效果随时间而变的 DID 模型的模拟，结合ESA（Event Study Approach）对 DID 最重要的平行趋势假设进行了检验，另外利用 coefplot 命令对 DID 方法所估计的政策动态效果进行了图形化展示。</li>
</ul>
<p><strong>二、多期DID模型——政策时点存在差异且实验组个体又不断变动的时变倍分法 (Time-varying DID) 模型&amp;与ESA 方法结合思路（不存在一直处于控制组的个体）</strong></p>
<p><em>由于现实世界中很多的政策试点地区和时间都不尽相同，而且也容易发生个体是否接受政策干预的状态在不停地发生改变，因此，使用渐进 DID 方法（Time-varying DID）来使得 DID 模型更加具有一般性。</em></p>
<ul>
<li>多期DID模型</li>
</ul>
<figure data-type="image" tabindex="4"><img src="https://gemliu.github.io/post-images/1627279560921.png" alt="" loading="lazy"></figure>
<p><strong>1）Time-varyig DID Simulation: 政策效果不随时间发生变化</strong></p>
<ul>
<li>
<p>模拟数据生成<br>
<img src="https://gemliu.github.io/post-images/1627281115354.png" alt="" loading="lazy"></p>
</li>
<li>
<p>多种估计结果的呈现<br>
<img src="https://gemliu.github.io/post-images/1627281744246.png" alt="" loading="lazy"></p>
</li>
<li>
<p>ESA 方法应用 (Event Study Approach)<br>
由于该方法对于所有个体没有一个统一的政策时点，且进入实验组的个体在不断变化，因此传统DID操作流程无法应用到 Time-varying DID 方法上。</p>
</li>
</ul>
<p>但是对于 Time-varying DID 来说，即使没有了统一的政策时点，由于【每一个个体进入实验组的时点是确定的】，所以可以通过【当前年份与该个体的政策时点相比较】。</p>
<p>换言之，Standard DID 结合 ESA 方法所生成的时期虚拟变量是一种绝对的时间尺度，即观测政策在某个样本时期的效果，所需要的相对时期，即观测政策效果在个体接受处理的前 N 期和后 N 期的变化。</p>
<figure data-type="image" tabindex="5"><img src="https://gemliu.github.io/post-images/1627304935487.png" alt="" loading="lazy"></figure>
<p><strong>2）Time-varyig DID Simulation: 政策效果随时间发生变化</strong></p>
<ul>
<li>
<p>模拟数据生成<br>
<img src="https://gemliu.github.io/post-images/1627288108778.png" alt="" loading="lazy"></p>
</li>
<li>
<p>多种估计结果的呈现<br>
<img src="https://gemliu.github.io/post-images/1627288785404.png" alt="" loading="lazy"></p>
</li>
<li>
<p>ESA方法的应用<br>
<img src="https://gemliu.github.io/post-images/1627289665774.png" alt="" loading="lazy"></p>
</li>
<li>
<p>小结<br>
通过数据模拟对多期DID方法多种形式的估计，对多期DID方法难以直观上理解的平行趋势检验做了分析和展示，结合 ESA 方法图示化了政策效果的动态性。</p>
</li>
</ul>
<p><em>Standard DID 结合 ESA 方法所生成的时期虚拟变量是一种绝对的时间尺度，而 Time-varying DID 利用 ESA 方法所需要的是相对的时期</em></p>
<p>一般认为 DID 方法的识别假设为结果变量的差分形式独立于政策干预，即在差分意义上满足随机实验的要求。因此，从分组的角度来说，DID 方法可以理解为【差分意义上的匹配方法】，因此在平行趋势检验的时候需要注意结果变量水平值的形式，比如取不取Log，可能会导致平行趋势检验结果的大不同。</p>
<p>【DID 方法和 ESA 方法的结合】利用【回归形式检验平行趋势】的方法，可以从另一个角度理解其识别假设或者说平行趋势假设：实验组和控制组的固有差异在样本期间的每一个时期内没有发生结构性的变化，政策干预也不会影响到组间固有差异。</p>
<p>从 ESA 方法角度去理解即，若原来水平值满足平行趋势假设，那么结果变量差分值就满足 ESA 方法所得到时间窗口期前的估计系数应该都不显著异于零。当然，即使利用一定的方法验证了结果变量具有平行趋势，比如在政策实施前实验组和控制组的变化趋势相同或者 ESA 方法的回归系数接近 0 ，依然无法保证政策实施后的平行趋势依然满足，因为本质上平行趋势假设依然是不可检测的。</p>
<p><strong>三、多期DID模型——时变倍分法 (Time-varying DID) 模型&amp;与ESA 方法结合思路（存在一直处于控制组的个体）</strong></p>
<p><strong>1）由于政策效果是否随时间变化不会改变我们的分析，因此仅分析【政策效果随时间发生变化的情况】</strong></p>
<ul>
<li>
<p>模拟数据的生成<br>
<img src="https://gemliu.github.io/post-images/1627291484031.png" alt="" loading="lazy"></p>
</li>
<li>
<p>多种估计结果的展示<br>
<img src="https://gemliu.github.io/post-images/1627292104702.png" alt="" loading="lazy"></p>
</li>
<li>
<p>ESA 方法应用<br>
在设定相对时间值的时候，如果存在一直在控制组的个体，一直没有接受干预，那么就不存在有政策前 N 期和政策后 N 期。因此它的赋值将成为问题。如果将这些个体的相对时间值设定为缺失值，则会导致这些个体的相对时间值的虚拟变量也会是缺失值。这会使得 ESA 方程可用的个体仅剩下了样本中的实验组个体，从而无法实现估计出每年度的政策效果进而对平行趋势进行检验的目的。可行的方法是【在生成每一个个体的相对时间值的虚拟变量后】，【手动将虚拟变量中的缺失值赋值为0】。从而在回归中利用上这些个体。并且将这些个体的缺失值赋值为0还可以表示它们是【控制组个体】。<br>
<img src="https://gemliu.github.io/post-images/1627301311157.png" alt="" loading="lazy"></p>
</li>
</ul>
<p><strong>参考资料:</strong><br>
https://zhuanlan.zhihu.com/p/48952513<br>
https://www.lianxh.cn/news/73a938e236d82.html<br>
https://www.lianxh.cn/news/c72c6fe03a580.html<br>
https://www.lianxh.cn/news/49014f33b87f9.html</p>

                    </div>

                </div>
            </article>

            <section class="comments-area">
    <div class="inner">
        <h2 class="screen-reader-text">评论</h2>
        
    </div>
</section>


            
                <nav class="post-navigation">
                    <h2 class="screen-reader-text">Post navigation</h2>
                    <div class="nav-links">
                        <a href="https://gemliu.github.io/lesslesswu-ai-ji-greatergreater-huang-bi-yun-xiao-shuo-ping-lun/" class="nav-previous">
                            <div class="nav-bg" >
                                
                                    <img srcset="https://gemliu.github.io/post-images/lesslesswu-ai-ji-greatergreater-huang-bi-yun-xiao-shuo-ping-lun.jpg 300w, https://gemliu.github.io/post-images/lesslesswu-ai-ji-greatergreater-huang-bi-yun-xiao-shuo-ping-lun.jpg 600w, https://gemliu.github.io/post-images/lesslesswu-ai-ji-greatergreater-huang-bi-yun-xiao-shuo-ping-lun.jpg 800w, https://gemliu.github.io/post-images/lesslesswu-ai-ji-greatergreater-huang-bi-yun-xiao-shuo-ping-lun.jpg 1600w, https://gemliu.github.io/post-images/lesslesswu-ai-ji-greatergreater-huang-bi-yun-xiao-shuo-ping-lun.jpg 2000w" sizes="(max-width: 800px) 100vw, 50vw" src="https://gemliu.github.io/post-images/lesslesswu-ai-ji-greatergreater-huang-bi-yun-xiao-shuo-ping-lun.jpg" alt="图裂了"/>
                                
                            </div>
                            <div class="nav-inside">
                                <span class="nav-before">下一篇</span>
                                <span class="nav-title">【读书笔记】《無愛紀》黃碧雲（小說評論）</span>
                                <span class="nav-date">2021-03-08</span>
                            </div>
                        </a>
                    </div>
                </nav>
            

        </div>
    </main>

    <footer class="site-footer">
    <div class="inner">
        <!-- 社交 -->
        <div class="offsite-links">
            
                
            
                
            
                
            
                
            
                
            
        </div>

        <div class="site-info">
            <a href="https://twitter.com/GEMLIU6">DISCUSS ON TWITTER GEMLIU</a><br/>
            ALL RIGHTS RESERVED © 1998-2022 GEMLIU
        </div>
        <a href="#page" class="arrow-up" data-scroll><span class="screen-reader-text">Back to the top</span></a>
    </div>
</footer>


</div>

<script src="https://gemliu.github.io/media/scripts/_core/plugins.js"></script>
<script src="https://gemliu.github.io/media/scripts/_core/custom.js"></script>

<!-- highlight -->
<script src="https://cdn.bootcss.com/highlight.js/9.15.8/highlight.min.js"></script>
<!-- Md5 Min JS -->
<script src="https://gemliu.github.io/media/scripts/_vendors/md5.min.js"></script>

<script type="application/javascript">
    // 代码高亮
    hljs.initHighlightingOnLoad();

</script>





</body>
</html>
